

      SUBROUTINE UPHOTG(BETA,ANGLE,IPART,N_PHOT,AV_PHOT)
c.......................................................................
c..   Routine for generation of the PHOTOELECTRONS
c..
c..   BETA    - beta of particle
c..   ANGLE   - angle between particles momentum and fiber (degree)
c..   IPART   - particle's TYPE
c..   N_PHOT  - generated numbers of photons for different numerical
c..             appertures(OUTPUT)
c..   AV_PHOT - average numb. of PhEl.'s
c........................................................................

      PARAMETER (N_ANG=18)
      DIMENSION ANG_DAT(N_ANG)
      DATA ANG_DAT/5.,10.,15.,20.,25.,30.,35.,40.,45.,
     +             50.,55.,60.,65.,70.,75.,80.,85.,90./

      PARAMETER (N_ANG_E=36)
      DIMENSION ANG_DAT_E(N_ANG_E)
      DATA ANG_DAT_E/5.,10.,15.,20.,25.,30.,35.,40.,45.,
     +             50.,55.,60.,65.,70.,75.,80.,85.,90.,
     +             95,100.,105.,110.,115.,120.,125.,130.,135.,
     +             140.,145.,150.,155.,160.,165.,170.,175.,180./

      PARAMETER (N_BET=9)
      DIMENSION BET_DAT(N_BET)
      DATA BET_DAT/0.70,0.75,0.80,0.85,0.90,0.92,0.95,0.98,1.00/

      PARAMETER (N_ELE=11)
      DIMENSION P_ELE(N_ELE)
      DATA P_ELE/0.0005,0.00055,0.0006,0.00075,0.001,0.0015,
     +           0.002,0.003,0.005,0.01,0.05/

      PARAMETER (I_DT=162)
      DIMENSION PMMA03(I_DT),PMMA04(I_DT),PMMA05(I_DT)
      PARAMETER (IE_DT=396)
      DIMENSION PMMA03_E(IE_DT),PMMA04_E(IE_DT),PMMA05_E(IE_DT)

C... Calculated data for average Cherenkov's photons yield at different
c    values of particle velosity and angle for heavy part.
c    ( momentum and angle for electrons). Data have been averaged over
c    impact parameter for PMMA 0.5 mm diameter fibers with N(core)=1.49.

c    Fibers was "Black painted"; 0.5mm Air gap between fibers bandle and
c    PMT entrance (Nrefr=1.5)
c...

C... Data for NA=0.3, Heavy particles:
      DATA PMMA03/
     + 6.569, 3.532, 2.065, 1.275, 0.732, 0.207, 0.080, 0.052, 0.018,
     + 0.009, 0.002, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,

     + 2.500, 1.586, 2.590, 2.504, 1.973, 1.446, 0.960, 0.274, 0.103,
     + 0.063, 0.039, 0.010, 0.007, 0.000, 0.000, 0.000, 0.000, 0.000,

     + 1.956, 1.006, 0.903, 1.344, 2.195, 2.024, 1.701, 1.213, 0.499,
     + 0.182, 0.081, 0.033, 0.033, 0.011, 0.000, 0.000, 0.000, 0.000,

     + 1.379, 0.676, 0.617, 0.702, 1.162, 2.013, 1.998, 1.616, 1.267,
     + 0.506, 0.180, 0.116, 0.061, 0.027, 0.012, 0.000, 0.000, 0.000,

     + 0.822, 0.544, 0.446, 0.506, 0.641, 1.332, 1.948, 1.869, 1.637,
     + 1.060, 0.451, 0.159, 0.085, 0.056, 0.031, 0.018, 0.000, 0.000,

     + 0.675, 0.471, 0.428, 0.437, 0.528, 0.926, 1.823, 1.946, 1.723,
     + 1.273, 0.598, 0.207, 0.118, 0.059, 0.040, 0.020, 0.000, 0.000,

     + 0.396, 0.368, 0.350, 0.390, 0.444, 0.690, 1.686, 1.827, 1.791,
     + 1.402, 0.983, 0.313, 0.146, 0.076, 0.036, 0.029, 0.011, 0.000,

     + 0.003, 0.337, 0.323, 0.313, 0.386, 0.594, 1.232, 1.994, 1.785,
     + 1.642, 1.241, 0.419, 0.197, 0.093, 0.069, 0.030, 0.021, 0.000,

     + 0.000, 0.300, 0.252, 0.287, 0.331, 0.463, 0.931, 1.799, 1.855,
     + 1.642, 1.309, 0.589, 0.214, 0.112, 0.066, 0.035, 0.022, 0.000
     +/

c.. Data for NA=0.3; ELECTRONS:
      DATA PMMA03_E/
     + 0.007, 0.009, 0.017, 0.019, 0.030, 0.023, 0.030, 0.020, 0.012,
     + 0.004, 0.003, 0.002, 0.001, 0.002, 0.000, 0.001, 0.001, 0.000,
     + 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
     + 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,

     + 0.022, 0.062, 0.133, 0.162, 0.167, 0.155, 0.124, 0.093, 0.068,
     + 0.045, 0.029, 0.017, 0.017, 0.013, 0.003, 0.000, 0.002, 0.000,
     + 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
     + 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,

     + 0.089, 0.168, 0.277, 0.311, 0.293, 0.333, 0.283, 0.192, 0.161,
     + 0.123, 0.075, 0.037, 0.037, 0.036, 0.027, 0.018, 0.011, 0.011,
     +0.004,0.003,0.002,0.001,0.002,0.001,0.001,0.001,0.000,0.000,
     +0.001,0.000,0.000,0.000,0.000,0.000,0.,0.,

     + 0.341, 0.483, 0.696, 0.738, 0.737, 0.781, 0.723, 0.603, 0.534,
     + 0.415, 0.259, 0.253, 0.170, 0.101, 0.111, 0.068, 0.047, 0.035,
     +0.022,0.014,0.013,0.012,0.009,0.008,0.007,0.007,0.005,0.005,
     +0.003,0.003,0.004,0.003,0.002,0.000,0.,0.,

     + 0.581, 0.818, 0.904, 0.982, 1.119, 1.098, 1.142, 1.109, 1.011,
     + 0.776, 0.606, 0.447, 0.244, 0.191, 0.101, 0.075, 0.040, 0.033,
     +0.012,0.009,0.005,0.009,0.006,0.005,0.005,0.005,0.005,0.002,
     +0.006,0.003,0.004,0.005,0.003,0.000,0.,0.,

     + 0.564, 0.765, 0.891, 0.923, 1.051, 1.236, 1.362, 1.433, 1.456,
     + 1.200, 0.905, 0.515, 0.308, 0.159, 0.084, 0.052, 0.028, 0.008,
     +0.003,0.003,0.001,0.004,0.003,0.003,0.001,0.002,0.002,0.003,
     +0.003,0.002,0.001,0.001,0.002,0.000,0.,0.,

     + 0.506, 0.633, 0.628, 0.663, 0.890, 1.016, 1.416, 1.701, 1.642,
     + 1.396, 1.039, 0.565, 0.288, 0.137, 0.071, 0.055, 0.019, 0.005,
     +0.002,0.000,0.001,0.001,0.000,0.001,0.001,0.001,0.001,0.001,
     +0.001,0.000,0.002,0.001,0.001,0.000,0.,0.,

     + 0.405, 0.407, 0.436, 0.437, 0.567, 0.763, 1.252, 1.680, 1.887,
     + 1.674, 1.190, 0.554, 0.240, 0.121, 0.061, 0.044, 0.021, 0.003,
     +0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.001,
     +0.000,0.001,0.001,0.000,0.000,0.000,0.,0.,

     + 0.241, 0.283, 0.352, 0.374, 0.397, 0.595, 1.064, 1.856, 1.828,
     + 1.615, 1.232, 0.589, 0.195, 0.103, 0.077, 0.042, 0.020, 0.000,
     +0.001,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,
     +0.000,0.000,0.000,0.000,0.000,0.000,0.,0.,

     + 0.144, 0.298, 0.303, 0.303, 0.347, 0.491, 0.904, 1.939, 1.786,
     + 1.661, 1.356, 0.559, 0.204, 0.136, 0.069, 0.040, 0.022, 0.002,
     +0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,
     +0.000,0.000,0.000,0.000,0.000,0.000,0.,0.,

     + 0.003, 0.239, 0.297, 0.309, 0.363, 0.501, 1.005, 1.903, 1.902,
     + 1.728, 1.371, 0.546, 0.242, 0.131, 0.061, 0.031, 0.020, 0.000,
     +0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,
     +0.000,0.000,0.000,0.000,0.000,0.000,0.,0.
     +/
C.....     Data for NA=0.4; Heavy particles:
      DATA PMMA04/
     +11.832, 5.169, 2.846, 1.798, 1.136, 0.640, 0.218, 0.101, 0.042,
     + 0.033, 0.005, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,

     + 6.235, 4.776, 4.738, 3.443, 2.646, 1.964, 1.444, 0.919, 0.314,
     + 0.151, 0.090, 0.042, 0.019, 0.000, 0.000, 0.000, 0.000, 0.000,

     + 4.797, 2.677, 2.490, 3.705, 3.213, 2.678, 2.152, 1.676, 1.215,
     + 0.470, 0.228, 0.093, 0.073, 0.039, 0.000, 0.000, 0.000, 0.000,

     + 3.243, 1.746, 1.578, 1.770, 3.162, 2.935, 2.605, 2.174, 1.735,
     + 1.262, 0.519, 0.225, 0.117, 0.071, 0.040, 0.000, 0.000, 0.000,

     + 2.058, 1.277, 1.113, 1.287, 1.946, 2.978, 2.883, 2.520, 2.049,
     + 1.696, 1.195, 0.491, 0.216, 0.120, 0.072, 0.037, 0.000, 0.000,

     + 1.601, 1.140, 1.008, 1.123, 1.539, 2.676, 2.809, 2.701, 2.312,
     + 1.804, 1.392, 0.594, 0.329, 0.147, 0.104, 0.042, 0.000, 0.000,

     + 0.985, 0.930, 0.891, 0.957, 1.239, 2.449, 2.807, 2.644, 2.375,
     + 1.957, 1.580, 0.971, 0.397, 0.197, 0.123, 0.061, 0.025, 0.000,

     + 0.003, 0.799, 0.800, 0.833, 1.069, 1.622, 2.757, 2.700, 2.418,
     + 2.205, 1.716, 1.314, 0.548, 0.233, 0.172, 0.081, 0.056, 0.001,

     + 0.000, 0.671, 0.719, 0.783, 0.908, 1.406, 2.526, 2.619, 2.509,
     + 2.182, 1.916, 1.397, 0.631, 0.260, 0.161, 0.101, 0.046, 0.000
     +/

c.. Data for NA=0.4; ELECTRONS:
      DATA PMMA04_E/
     + 0.007, 0.010, 0.018, 0.030, 0.034, 0.039, 0.033, 0.020, 0.018,
     + 0.008, 0.002, 0.009, 0.000, 0.003, 0.000, 0.001, 0.002, 0.000,
     + 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
     + 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,

     + 0.048, 0.117, 0.199, 0.228, 0.249, 0.232, 0.213, 0.142, 0.093,
     + 0.072, 0.051, 0.031, 0.022, 0.013, 0.012, 0.011, 0.001, 0.009,
     + 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
     + 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,

     + 0.148, 0.283, 0.457, 0.555, 0.507, 0.489, 0.407, 0.319, 0.273,
     + 0.183, 0.150, 0.092, 0.072, 0.050, 0.042, 0.022, 0.011, 0.011,
     +0.006,0.004,0.003,0.003,0.002,0.002,0.001,0.002,0.001,0.001,
     +0.001,0.000,0.000,0.000,0.000,0.000,0.,0.,

     + 0.548, 0.901, 1.092, 1.164, 1.176, 1.197, 1.213, 1.004, 0.891,
     + 0.694, 0.499, 0.382, 0.300, 0.213, 0.201, 0.125, 0.088, 0.077,
     +0.032,0.026,0.023,0.017,0.017,0.009,0.009,0.010,0.008,0.009,
     +0.008,0.008,0.007,0.006,0.004,0.000,0.,0.,

     + 1.060, 1.371, 1.597, 1.865, 1.782, 1.864, 1.945, 1.753, 1.654,
     + 1.304, 1.005, 0.711, 0.540, 0.408, 0.261, 0.158, 0.092, 0.062,
     +0.020,0.017,0.020,0.009,0.012,0.009,0.011,0.008,0.008,0.006,
     +0.007,0.009,0.007,0.005,0.005,0.000,0.,0.,

     + 1.181, 1.531, 1.800, 1.803, 1.902, 2.173, 2.217, 2.317, 2.180,
     + 1.871, 1.513, 1.136, 0.581, 0.380, 0.206, 0.137, 0.075, 0.020,
     +0.005,0.005,0.003,0.003,0.003,0.002,0.003,0.002,0.004,0.003,
     +0.004,0.004,0.003,0.005,0.003,0.000,0.,0.,

     + 1.140, 1.349, 1.432, 1.514, 1.696, 2.079, 2.424, 2.436, 2.376,
     + 2.117, 1.636, 1.235, 0.621, 0.360, 0.167, 0.123, 0.052, 0.021,
     +0.002,0.001,0.001,0.001,0.002,0.002,0.001,0.000,0.003,0.002,
     +0.002,0.003,0.001,0.001,0.002,0.000,0.,0.,

     + 0.878, 0.888, 0.972, 1.154, 1.346, 1.876, 2.537, 2.640, 2.500,
     + 2.157, 1.839, 1.264, 0.648, 0.332, 0.178, 0.096, 0.038, 0.005,
     +0.001,0.001,0.000,0.000,0.000,0.000,0.000,0.001,0.001,0.001,
     +0.000,0.002,0.001,0.001,0.001,0.000,0.,0.,

     + 0.534, 0.802, 0.824, 0.902, 1.082, 1.560, 2.540, 2.629, 2.461,
     + 2.315, 1.863, 1.378, 0.630, 0.299, 0.169, 0.080, 0.048, 0.002,
     +0.000,0.000,0.000,0.000,0.000,0.000,0.001,0.000,0.000,0.000,
     +0.000,0.000,0.000,0.000,0.000,0.000,0.,0.,

     + 0.312, 0.671, 0.758, 0.779, 0.919, 1.378, 2.498, 2.665, 2.528,
     + 2.201, 1.877, 1.400, 0.602, 0.316, 0.178, 0.090, 0.050, 0.002,
     +0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,
     +0.000,0.000,0.000,0.000,0.000,0.000,0.,0.,

     + 0.007, 0.701, 0.709, 0.788, 0.963, 1.358, 2.572, 2.739, 2.684,
     + 2.308, 1.844, 1.441, 0.632, 0.328, 0.181, 0.103, 0.052, 0.000,
     +0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,
     +0.000,0.000,0.000,0.000,0.000,0.000,0.,0.
     +/
C... Data for NA=0.5; Heavy particles:
      DATA PMMA05/
     +16.258, 6.771, 3.844, 2.432, 1.531, 1.003, 0.543, 0.195, 0.102,
     + 0.053, 0.017, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,

     +14.722,10.130, 6.809, 4.436, 3.350, 2.558, 1.893, 1.404, 0.905,
     + 0.314, 0.173, 0.094, 0.046, 0.000, 0.000, 0.000, 0.000, 0.000,

     + 9.922, 5.795, 6.179, 5.376, 4.152, 3.399, 2.779, 2.161, 1.745,
     + 1.171, 0.479, 0.233, 0.128, 0.080, 0.000, 0.000, 0.000, 0.000,

     + 6.800, 3.826, 3.449, 4.751, 4.478, 3.885, 3.413, 2.713, 2.294,
     + 1.874, 1.264, 0.590, 0.301, 0.166, 0.095, 0.000, 0.000, 0.000,

     + 4.222, 2.743, 2.408, 2.871, 4.146, 4.024, 3.620, 3.134, 2.713,
     + 2.232, 1.790, 1.187, 0.527, 0.284, 0.150, 0.076, 0.000, 0.000,

     + 3.349, 2.428, 2.112, 2.526, 3.986, 4.061, 3.705, 3.200, 2.861,
     + 2.437, 1.790, 1.482, 0.589, 0.355, 0.196, 0.081, 0.000, 0.000,

     + 1.825, 1.986, 1.961, 2.171, 3.075, 3.915, 3.783, 3.268, 2.912,
     + 2.561, 2.072, 1.659, 0.930, 0.425, 0.240, 0.131, 0.054, 0.000,

     + 0.019, 1.612, 1.741, 1.827, 2.285, 3.659, 3.723, 3.512, 3.093,
     + 2.664, 2.319, 1.776, 1.283, 0.545, 0.328, 0.192, 0.084, 0.000,

     + 0.000, 1.365, 1.446, 1.764, 2.082, 3.662, 3.548, 3.443, 3.128,
     + 2.777, 2.355, 1.936, 1.431, 0.636, 0.340, 0.235, 0.101, 0.000
     +/
C.. Data for NA=0.5;  ELECTRONS:
      DATA PMMA05_E/
     + 0.002, 0.009, 0.012, 0.047, 0.066, 0.053, 0.046, 0.041, 0.033,
     + 0.014, 0.007, 0.005, 0.008, 0.001, 0.000, 0.000, 0.000, 0.000,
     + 0.001, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
     + 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,

     + 0.067, 0.141, 0.222, 0.319, 0.322, 0.296, 0.243, 0.212, 0.173,
     + 0.113, 0.104, 0.052, 0.039, 0.025, 0.027, 0.008, 0.007, 0.007,
     + 0.005, 0.004, 0.002, 0.005, 0.000, 0.001, 0.002, 0.000, 0.000,
     + 0.001, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,

     + 0.213, 0.385, 0.607, 0.635, 0.652, 0.602, 0.529, 0.479, 0.386,
     + 0.320, 0.235, 0.186, 0.135, 0.097, 0.074, 0.044, 0.031, 0.028,
     + 0.020, 0.022, 0.006, 0.008, 0.015, 0.007, 0.003, 0.001, 0.004,
     + 0.004, 0.000, 0.000, 0.002, 0.001, 0.002, 0.001, 0.000, 0.000,

     + 0.786, 1.278, 1.547, 1.718, 1.784, 1.748, 1.491, 1.442, 1.276,
     + 1.088, 0.839, 0.726, 0.473, 0.385, 0.275, 0.200, 0.165, 0.103,
     + 0.079, 0.074, 0.069, 0.049, 0.054, 0.021, 0.026, 0.024, 0.016,
     + 0.016, 0.009, 0.014, 0.011, 0.019, 0.008, 0.008, 0.001, 0.000,

     + 1.622, 2.173, 2.584, 2.687, 2.892, 2.845, 2.709, 2.448, 2.254,
     + 1.913, 1.579, 1.201, 0.883, 0.609, 0.390, 0.252, 0.147, 0.133,
     + 0.071, 0.067, 0.042, 0.023, 0.029, 0.022, 0.006, 0.018, 0.012,
     + 0.010, 0.004, 0.009, 0.006, 0.006, 0.004, 0.005, 0.007, 0.000,

     + 1.984, 2.660, 3.081, 3.080, 3.245, 3.449, 3.299, 3.096, 2.906,
     + 2.411, 2.063, 1.574, 1.049, 0.680, 0.411, 0.236, 0.097, 0.047,
     + 0.025, 0.017, 0.007, 0.006, 0.002, 0.006, 0.001, 0.008, 0.001,
     + 0.007, 0.005, 0.001, 0.001, 0.005, 0.015, 0.006, 0.009, 0.000,

     + 1.884, 2.399, 2.716, 2.779, 3.147, 3.487, 3.497, 3.365, 3.043,
     + 2.694, 2.232, 1.730, 1.186, 0.684, 0.359, 0.207, 0.073, 0.021,
     + 0.017, 0.017, 0.011, 0.000, 0.002, 0.001, 0.001, 0.002, 0.011,
     + 0.000, 0.003, 0.000, 0.008, 0.006, 0.014, 0.002, 0.000, 0.000,

     + 1.567, 1.873, 2.094, 2.311, 2.704, 3.493, 3.590, 3.454, 3.271,
     + 2.716, 2.385, 1.909, 1.421, 0.591, 0.353, 0.209, 0.112, 0.007,
     + 0.004, 0.000, 0.004, 0.001, 0.000, 0.004, 0.002, 0.004, 0.000,
     + 0.000, 0.000, 0.003, 0.000, 0.000, 0.005, 0.004, 0.000, 0.000,

     + 1.142, 1.426, 1.583, 1.928, 2.336, 3.395, 3.594, 3.382, 3.180,
     + 2.907, 2.347, 1.961, 1.445, 0.613, 0.382, 0.232, 0.109, 0.003,
     + 0.000, 0.000, 0.000, 0.000, 0.000, 0.001, 0.000, 0.001, 0.000,
     + 0.001, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,

     + 0.638, 1.437, 1.560, 1.646, 2.106, 3.539, 3.864, 3.497, 3.223,
     + 2.732, 2.345, 1.960, 1.440, 0.680, 0.367, 0.188, 0.099, 0.002,
     + 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
     + 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,

     + 0.020, 1.407, 1.434, 1.720, 2.081, 3.498, 3.577, 3.495, 3.205,
     + 2.788, 2.350, 2.039, 1.428, 0.684, 0.372, 0.201, 0.119, 0.000,
     + 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
     + 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000
     +/
      PARAMETER (NUM_AP=3)
      DIMENSION N_PHOT(NUM_AP),AV_PHOT(NUM_AP)
      DATA BET_THRE/0.671141/
c
      DOUBLE PRECISION EMASS,EMMU,PMASS
      PARAMETER (EMASS=0.0005109990615D0)
      PARAMETER (EMMU=0.105658387D0)
      PARAMETER (PMASS=0.9382723128D0)

C... EXP_NORM - normalization factor to exp. data:
c...            16PhEl/MIP/Module --> 0.593 phe/mip at 45 Degree for NA=0.5

      DATA EXP_NORM/0.16848/

      DO I=1,NUM_AP
      N_PHOT(I)=0
      AV_PHOT(I)=0.
      ENDDO
      IF(BETA.LE.BET_THRE) GO TO 1000

c..  Is Particle electron/positron?
      IF(IPART.EQ.2.OR.IPART.EQ.3) GO TO 100

      BET_MIN=BET_DAT(1)
      IF(BETA.LE.BET_MIN) GO TO 1000
c.. Heavy particle:
      DO I=2,N_BET
      IF(BETA.LT.BET_DAT(I)) GO TO 10
      ENDDO
      I=N_BET
   10 CONTINUE
      J1=(I-2)*N_ANG+1
      J2=J1+N_ANG
      B1=BET_DAT(I-1)
      B2=BET_DAT(I)
C.......   NA=0.3:
      A1=DIVDIF(PMMA03(J1),ANG_DAT(1),N_ANG,ANGLE,1)
      IF(A1.LE.0.) A1=0.
      A2=DIVDIF(PMMA03(J2),ANG_DAT(1),N_ANG,ANGLE,1)
      IF(A2.LE.0.) A2=0.
      AV_PH=((A2-A1)/(B2-B1)*(BETA-B1)+A1)*EXP_NORM

      CALL RNPSSN(AV_PH,NPH,IERR)
      N_PHOT(1)=NPH
      AV_PHOT(1)=AV_PH
C........ NA=0.4:
      A1=DIVDIF(PMMA04(J1),ANG_DAT(1),N_ANG,ANGLE,1)
      IF(A1.LE.0.) A1=0.
      A2=DIVDIF(PMMA04(J2),ANG_DAT(1),N_ANG,ANGLE,1)
      IF(A2.LE.0.) A2=0.
      AV_PH=((A2-A1)/(B2-B1)*(BETA-B1)+A1)*EXP_NORM

      CALL RNPSSN(AV_PH,NPH,IERR)
      N_PHOT(2)=NPH
      AV_PHOT(2)=AV_PH
C.......   NA=0.5:
      A1=DIVDIF(PMMA05(J1),ANG_DAT(1),N_ANG,ANGLE,1)
      IF(A1.LE.0.) A1=0.
      A2=DIVDIF(PMMA05(J2),ANG_DAT(1),N_ANG,ANGLE,1)
      IF(A2.LE.0.) A2=0.
      AV_PH=((A2-A1)/(B2-B1)*(BETA-B1)+A1)*EXP_NORM

      CALL RNPSSN(AV_PH,NPH,IERR)
      N_PHOT(3)=NPH
      AV_PHOT(3)=AV_PH
      GO TO 1000

c.. Electrons:
  100 CONTINUE
      XXX=SQRT(1./BETA**2-1.)
      IF(XXX.EQ.0.) XXX=0.000001
      P=EMASS/XXX
      IF(P.LE.P_ELE(1)) GO TO 1000
      IF(P.GE.P_ELE(N_ELE)) GO TO 999

      DO I=2,N_ELE
      IF(P.LT.P_ELE(I)) GO TO 20
      ENDDO

   20 CONTINUE
      J1=(I-2)*N_ANG_E+1
      J2=J1+N_ANG_E
      B1=P_ELE(I-1)
      B2=P_ELE(I)
C.......   NA=0.3
      A1=DIVDIF(PMMA03_E(J1),ANG_DAT_E(1),N_ANG_E,ANGLE,1)
      IF(A1.LE.0.) A1=0.
      A2=DIVDIF(PMMA03_E(J2),ANG_DAT_E(1),N_ANG_E,ANGLE,1)
      IF(A2.LE.0.) A2=0.
      AV_PH=((A2-A1)/(B2-B1)*(P-B1)+A1)*EXP_NORM
      IF(AV_PH.LE.0.) AV_PH=0.
      CALL RNPSSN(AV_PH,NPH,IERR)
      N_PHOT(1)=NPH
      AV_PHOT(1)=AV_PH
C........ NA=0.4
      A1=DIVDIF(PMMA04_E(J1),ANG_DAT_E(1),N_ANG_E,ANGLE,1)
      IF(A1.LE.0.) A1=0.
      A2=DIVDIF(PMMA04_E(J2),ANG_DAT_E(1),N_ANG_E,ANGLE,1)
      IF(A2.LE.0.) A2=0.
      AV_PH=((A2-A1)/(B2-B1)*(P-B1)+A1)*EXP_NORM
      IF(AV_PH.LE.0.) AV_PH=0.
      CALL RNPSSN(AV_PH,NPH,IERR)
      N_PHOT(2)=NPH
      AV_PHOT(2)=AV_PH
C.......  NA=0.5
      A1=DIVDIF(PMMA05_E(J1),ANG_DAT_E(1),N_ANG_E,ANGLE,1)
      IF(A1.LE.0.) A1=0.
      A2=DIVDIF(PMMA05_E(J2),ANG_DAT_E(1),N_ANG_E,ANGLE,1)
      IF(A2.LE.0.) A2=0.
      AV_PH=((A2-A1)/(B2-B1)*(P-B1)+A1)*EXP_NORM
      IF(AV_PH.LE.0.) AV_PH=0.
      CALL RNPSSN(AV_PH,NPH,IERR)
      N_PHOT(3)=NPH
      AV_PHOT(3)=AV_PH

      GO TO 1000
C...  Electrons with momentum > 50 Mev:
  999 CONTINUE
      J=(N_ELE-1)*N_ANG_E+1
      AV_PH=DIVDIF(PMMA03_E(J),ANG_DAT_E(1),N_ANG_E,ANGLE,1)
      IF(AV_PH.LE.0.) AV_PH=0.
      AV_PH=AV_PH*EXP_NORM
      CALL RNPSSN(AV_PH,NPH,IERR)
      N_PHOT(1)=NPH
      AV_PHOT(1)=AV_PH

      AV_PH=DIVDIF(PMMA04_E(J),ANG_DAT_E(1),N_ANG_E,ANGLE,1)
      IF(AV_PH.LE.0.) AV_PH=0.
      AV_PH=AV_PH*EXP_NORM
      CALL RNPSSN(AV_PH,NPH,IERR)
      N_PHOT(2)=NPH
      AV_PHOT(2)=AV_PH

      AV_PH=DIVDIF(PMMA05_E(J),ANG_DAT_E(1),N_ANG_E,ANGLE,1)
      IF(AV_PH.LE.0.) AV_PH=0.
      AV_PH=AV_PH*EXP_NORM
      CALL RNPSSN(AV_PH,NPH,IERR)
      N_PHOT(3)=NPH
      AV_PHOT(3)=AV_PH
 1000 CONTINUE
      RETURN
      END

