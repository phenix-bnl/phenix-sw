<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>/trees/alex/src/libodbc++/include/odbc++/resultset.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.14 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="namespacemembers.html">Namespace Members</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; </center>
<hr><h1>/trees/alex/src/libodbc++/include/odbc++/resultset.h</h1><div class="fragment"><pre>00001 <font class="comment">/* </font>
00002 <font class="comment">   This file is part of libodbc++.</font>
00003 <font class="comment">   </font>
00004 <font class="comment">   Copyright (C) 1999-2000 Manush Dodunekov &lt;manush@stendahls.net&gt;</font>
00005 <font class="comment">   </font>
00006 <font class="comment">   This library is free software; you can redistribute it and/or</font>
00007 <font class="comment">   modify it under the terms of the GNU Library General Public</font>
00008 <font class="comment">   License as published by the Free Software Foundation; either</font>
00009 <font class="comment">   version 2 of the License, or (at your option) any later version.</font>
00010 <font class="comment">   </font>
00011 <font class="comment">   This library is distributed in the hope that it will be useful,</font>
00012 <font class="comment">   but WITHOUT ANY WARRANTY; without even the implied warranty of</font>
00013 <font class="comment">   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</font>
00014 <font class="comment">   Library General Public License for more details.</font>
00015 <font class="comment">   </font>
00016 <font class="comment">   You should have received a copy of the GNU Library General Public License</font>
00017 <font class="comment">   along with this library; see the file COPYING.  If not, write to</font>
00018 <font class="comment">   the Free Software Foundation, Inc., 59 Temple Place - Suite 330,</font>
00019 <font class="comment">   Boston, MA 02111-1307, USA.</font>
00020 <font class="comment">*/</font>
00021 
00022 <font class="preprocessor">#ifndef __ODBCXX_RESULTSET_H</font>
00023 <font class="preprocessor"></font><font class="preprocessor">#define __ODBCXX_RESULTSET_H</font>
00024 <font class="preprocessor"></font>
00025 <font class="preprocessor">#include &lt;odbc++/setup.h&gt;</font>
00026 <font class="preprocessor">#include &lt;odbc++/types.h&gt;</font>
00027 <font class="preprocessor">#include &lt;odbc++/errorhandler.h&gt;</font>
00028 <font class="preprocessor">#include &lt;odbc++/statement.h&gt;</font>
00029 
00030 
00031 <font class="keyword">namespace </font>odbc {
00032 
00033   <font class="keyword">class </font>ResultSetMetaData;
00034   <font class="keyword">class </font>Statement;
00035   <font class="keyword">class </font>Rowset;
00036 
<a name="l00038"></a><a class="code" href="classodbc_1_1_result_set.html">00038</a>   <font class="keyword">class </font>ODBCXX_EXPORT ResultSet : <font class="keyword">public</font> ErrorHandler {
00039     <font class="keyword">friend</font> <font class="keyword">class </font>Statement;
00040     <font class="keyword">friend</font> <font class="keyword">class </font>ResultSetMetaData;
00041     
00042   <font class="keyword">private</font>:
00043     Statement* statement_;
00044     SQLHSTMT hstmt_;
00045     <font class="keywordtype">bool</font> ownStatement_;
00046 
00047 
00048     <font class="keywordtype">int</font> currentFetchSize_;
00049     <font class="keywordtype">int</font> newFetchSize_;
00050 
00051     Rowset* rowset_;
00052     SQLUSMALLINT* rowStatus_;
00053     SQLUINTEGER rowsInRowset_;
00054 
00055     <font class="comment">//tells us if the columns are bound right now</font>
00056     <font class="keywordtype">bool</font> colsBound_;
00057     <font class="keywordtype">bool</font> streamedColsBound_;
00058 
00059     <font class="comment">//the position in the rowset last time we did a bind</font>
00060     <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> bindPos_;
00061 
00062     <font class="comment">//meta data - it's always there since we need info from it</font>
00063     ResultSetMetaData* metaData_;
00064 
00065     <font class="keywordtype">int</font> location_;
00066     
00067     <font class="keywordtype">bool</font> lastWasNull_;
00068 
00069     <font class="keywordtype">int</font> rowBeforeInsert_;
00070     <font class="keywordtype">int</font> locBeforeInsert_;
00071 
00072     ResultSet(Statement* stmt,SQLHSTMT hstmt, <font class="keywordtype">bool</font> ownStmt);
00073     
00074     <font class="comment">//driver info</font>
00075     <font class="keyword">const</font> DriverInfo* _getDriverInfo()<font class="keyword"> const </font>{
00076       <font class="keywordflow">return</font> statement_-&gt;_getDriverInfo();
00077     }
00078 
00079     <font class="comment">//private utils</font>
00080     <font class="keywordtype">void</font> _applyFetchSize();
00081     <font class="comment">//this makes sure there is a rowset </font>
00082     <font class="keywordtype">void</font> _resetRowset();
00083 
00084     <font class="comment">//this should be called before any call to SQLExtendedFetch</font>
00085     <font class="keywordtype">void</font> _prepareForFetch();
00086     <font class="comment">//this performs a possibly scrolled fetch with fetchType to rownum</font>
00087     <font class="keywordtype">void</font> _doFetch(<font class="keywordtype">int</font> fetchType, <font class="keywordtype">int</font> rowNum);
00088 
00089     <font class="comment">//this should be called after the position in the rowset changes</font>
00090     SQLRETURN _applyPosition(<font class="keywordtype">int</font> mode =SQL_POSITION);
00091 
00092     <font class="comment">//these bind/unbind all non-streamed columns</font>
00093     <font class="keywordtype">void</font> _bindCols();
00094     <font class="keywordtype">void</font> _unbindCols();
00095 
00096     <font class="comment">//these bind/unbind all streamed columns</font>
00097     <font class="keywordtype">void</font> _bindStreamedCols();
00098     <font class="keywordtype">void</font> _unbindStreamedCols();
00099     
00100     <font class="comment">//this sends all needed data from streamed columns</font>
00101     <font class="comment">//to be called from insertRow and updateRow</font>
00102     <font class="keywordtype">void</font> _handleStreams(SQLRETURN r);
00103     
00104 
00105   <font class="keyword">public</font>:
00107     <font class="keyword">virtual</font> ~ResultSet();
00108     
00109     <font class="comment">//remember to update DatabaseMetaData when changing those values</font>
00110 
00113     <font class="keyword">enum</font> {
00115       CONCUR_READ_ONLY,
00117       CONCUR_UPDATABLE
00118     };
00119 
00120 
00123     <font class="keyword">enum</font> {
00125       TYPE_FORWARD_ONLY,
00129       TYPE_SCROLL_INSENSITIVE,
00131       TYPE_SCROLL_SENSITIVE
00132     };
00133 
00140     <font class="keywordtype">bool</font> absolute(<font class="keywordtype">int</font> row);
00141 
00147     <font class="keywordtype">bool</font> relative(<font class="keywordtype">int</font> rows);
00148 
00150     <font class="keywordtype">void</font> afterLast();
00151 
00153     <font class="keywordtype">void</font> beforeFirst();
00154 
00156     <font class="keywordtype">bool</font> isAfterLast();
00157 
00159     <font class="keywordtype">bool</font> isBeforeFirst();
00160 
00162     <font class="keywordtype">bool</font> isFirst();
00163 
00166     <font class="keywordtype">bool</font> isLast();
00167 
00172     <font class="keywordtype">int</font> getRow();
00173 
00177     <font class="keywordtype">bool</font> next();
00178 
00182     <font class="keywordtype">bool</font> previous();
00183 
00187     <font class="keywordtype">bool</font> first();
00188 
00192     <font class="keywordtype">bool</font> last();
00193 
00199     <font class="keywordtype">void</font> moveToInsertRow();
00200     
00204     <font class="keywordtype">void</font> moveToCurrentRow();
00205 
00207     <font class="keywordtype">void</font> refreshRow();
00208 
00210     <font class="keywordtype">void</font> deleteRow();
00211 
00216     <font class="keywordtype">void</font> insertRow();
00217 
00219     <font class="keywordtype">void</font> updateRow();
00220 
00222     <font class="keywordtype">void</font> cancelRowUpdates();
00223 
<a name="l00227"></a><a class="code" href="classodbc_1_1_result_set.html#a21">00227</a>     ResultSetMetaData* getMetaData() {
00228       <font class="keywordflow">return</font> metaData_;
00229     }
00230 
00232     <font class="keywordtype">int</font> findColumn(<font class="keyword">const</font> ODBCXX_STRING&amp; colName);
00233 
00235     <font class="keywordtype">bool</font> rowDeleted();
00236 
00238     <font class="keywordtype">bool</font> rowInserted();
00239 
00241     <font class="keywordtype">bool</font> rowUpdated();
00242 
00244     <font class="keywordtype">int</font> getType();
00245 
00247     <font class="keywordtype">int</font> getConcurrency();
00248     
00249     
<a name="l00251"></a><a class="code" href="classodbc_1_1_result_set.html#a28">00251</a>     <font class="keywordtype">int</font> getFetchSize() {
00252       <font class="keywordflow">return</font> newFetchSize_;
00253     }
00254 
00256     <font class="keywordtype">void</font> setFetchSize(<font class="keywordtype">int</font> fetchSize);
00257 
00259     ODBCXX_STRING getCursorName();
00260 
<a name="l00262"></a><a class="code" href="classodbc_1_1_result_set.html#a31">00262</a>     Statement* getStatement() {
00263       <font class="keywordflow">return</font> statement_;
00264     }
00265 
00269     <font class="keywordtype">double</font> getDouble(<font class="keywordtype">int</font> idx);
00270 
00274     <font class="keywordtype">bool</font> getBoolean(<font class="keywordtype">int</font> idx);
00275 
00279     <font class="keywordtype">signed</font> <font class="keywordtype">char</font> getByte(<font class="keywordtype">int</font> idx);
00280 
00285     ODBCXX_BYTES getBytes(<font class="keywordtype">int</font> idx);
00286 
00290     Date getDate(<font class="keywordtype">int</font> idx);
00291 
00295     <font class="keywordtype">float</font> getFloat(<font class="keywordtype">int</font> idx);
00296 
00300     <font class="keywordtype">int</font> getInt(<font class="keywordtype">int</font> idx);
00301 
00305     Long getLong(<font class="keywordtype">int</font> idx);
00306 
00310     <font class="keywordtype">short</font> getShort(<font class="keywordtype">int</font> idx);
00311 
00315     ODBCXX_STRING getString(<font class="keywordtype">int</font> idx);
00316 
00320     Time getTime(<font class="keywordtype">int</font> idx);
00321 
00325     Timestamp getTimestamp(<font class="keywordtype">int</font> idx);
00326 
00330     <font class="keywordtype">double</font> getDouble(<font class="keyword">const</font> ODBCXX_STRING&amp; colName);
00331     
00335     <font class="keywordtype">bool</font> getBoolean(<font class="keyword">const</font> ODBCXX_STRING&amp; colName);
00336 
00340     <font class="keywordtype">signed</font> <font class="keywordtype">char</font> getByte(<font class="keyword">const</font> ODBCXX_STRING&amp; colName);
00341 
00342 
00346     ODBCXX_BYTES getBytes(<font class="keyword">const</font> ODBCXX_STRING&amp; colName);
00347 
00351     Date getDate(<font class="keyword">const</font> ODBCXX_STRING&amp; colName);
00352 
00356     <font class="keywordtype">float</font> getFloat(<font class="keyword">const</font> ODBCXX_STRING&amp; colName);
00357 
00361     <font class="keywordtype">int</font> getInt(<font class="keyword">const</font> ODBCXX_STRING&amp; colName);
00362 
00366     Long getLong(<font class="keyword">const</font> ODBCXX_STRING&amp; colName);
00367 
00371     <font class="keywordtype">short</font> getShort(<font class="keyword">const</font> ODBCXX_STRING&amp; colName);
00372 
00376     ODBCXX_STRING getString(<font class="keyword">const</font> ODBCXX_STRING&amp; colName);
00377 
00381     Time getTime(<font class="keyword">const</font> ODBCXX_STRING&amp; colName);
00382 
00386     Timestamp getTimestamp(<font class="keyword">const</font> ODBCXX_STRING&amp; colName);
00387 
00388 
00396     ODBCXX_STREAM* getAsciiStream(<font class="keywordtype">int</font> idx);
00397 
00405     ODBCXX_STREAM* getAsciiStream(<font class="keyword">const</font> ODBCXX_STRING&amp; colName);
00406 
00414     ODBCXX_STREAM* getBinaryStream(<font class="keywordtype">int</font> idx);
00415 
00423     ODBCXX_STREAM* getBinaryStream(<font class="keyword">const</font> ODBCXX_STRING&amp; colName);
00424     
<a name="l00428"></a><a class="code" href="classodbc_1_1_result_set.html#a60">00428</a>     <font class="keywordtype">bool</font> wasNull() {
00429       <font class="keywordflow">return</font> lastWasNull_;
00430     }
00431 
00436     <font class="keywordtype">void</font> updateDouble(<font class="keywordtype">int</font> idx, <font class="keywordtype">double</font> val);
00437 
00442     <font class="keywordtype">void</font> updateBoolean(<font class="keywordtype">int</font> idx, <font class="keywordtype">bool</font> val);
00443 
00448     <font class="keywordtype">void</font> updateByte(<font class="keywordtype">int</font> idx, <font class="keywordtype">signed</font> <font class="keywordtype">char</font> val);
00449 
00450 
00455     <font class="keywordtype">void</font> updateBytes(<font class="keywordtype">int</font> idx, <font class="keyword">const</font> ODBCXX_BYTES&amp; val);
00456 
00461     <font class="keywordtype">void</font> updateDate(<font class="keywordtype">int</font> idx, <font class="keyword">const</font> Date&amp; val);
00462 
00467     <font class="keywordtype">void</font> updateFloat(<font class="keywordtype">int</font> idx, <font class="keywordtype">float</font> val);
00468 
00473     <font class="keywordtype">void</font> updateInt(<font class="keywordtype">int</font> idx, <font class="keywordtype">int</font> val);
00474 
00479     <font class="keywordtype">void</font> updateLong(<font class="keywordtype">int</font> idx, Long val);
00480 
00485     <font class="keywordtype">void</font> updateShort(<font class="keywordtype">int</font> idx, <font class="keywordtype">short</font> val);
00486 
00491     <font class="keywordtype">void</font> updateString(<font class="keywordtype">int</font> idx, <font class="keyword">const</font> ODBCXX_STRING&amp; val);
00492 
00497     <font class="keywordtype">void</font> updateTime(<font class="keywordtype">int</font> idx, <font class="keyword">const</font> Time&amp; val);
00498 
00503     <font class="keywordtype">void</font> updateTimestamp(<font class="keywordtype">int</font> idx, <font class="keyword">const</font> Timestamp&amp; val);
00504 
00508     <font class="keywordtype">void</font> updateNull(<font class="keywordtype">int</font> idx);
00509 
00510 
00515     <font class="keywordtype">void</font> updateDouble(<font class="keyword">const</font> ODBCXX_STRING&amp; colName, <font class="keywordtype">double</font> val);
00516 
00521     <font class="keywordtype">void</font> updateBoolean(<font class="keyword">const</font> ODBCXX_STRING&amp; colName, <font class="keywordtype">bool</font> val);
00522 
00527     <font class="keywordtype">void</font> updateByte(<font class="keyword">const</font> ODBCXX_STRING&amp; colName, <font class="keywordtype">signed</font> <font class="keywordtype">char</font> val);
00528 
00533     <font class="keywordtype">void</font> updateBytes(<font class="keyword">const</font> ODBCXX_STRING&amp; colName, 
00534                      <font class="keyword">const</font> ODBCXX_BYTES&amp; val);
00535 
00536 
00541     <font class="keywordtype">void</font> updateDate(<font class="keyword">const</font> ODBCXX_STRING&amp; colName, <font class="keyword">const</font> Date&amp; val);
00542 
00547     <font class="keywordtype">void</font> updateFloat(<font class="keyword">const</font> ODBCXX_STRING&amp; colName, <font class="keywordtype">float</font> val);
00548 
00553     <font class="keywordtype">void</font> updateInt(<font class="keyword">const</font> ODBCXX_STRING&amp; colName, <font class="keywordtype">int</font> val);
00554 
00559     <font class="keywordtype">void</font> updateLong(<font class="keyword">const</font> ODBCXX_STRING&amp; colName, Long val);
00560 
00565     <font class="keywordtype">void</font> updateShort(<font class="keyword">const</font> ODBCXX_STRING&amp; colName, <font class="keywordtype">short</font> val);
00566 
00571     <font class="keywordtype">void</font> updateString(<font class="keyword">const</font> ODBCXX_STRING&amp; colName, <font class="keyword">const</font> ODBCXX_STRING&amp; val);
00572 
00577     <font class="keywordtype">void</font> updateTime(<font class="keyword">const</font> ODBCXX_STRING&amp; colName, <font class="keyword">const</font> Time&amp; val);
00578 
00583     <font class="keywordtype">void</font> updateTimestamp(<font class="keyword">const</font> ODBCXX_STRING&amp; colName, <font class="keyword">const</font> Timestamp&amp; val);
00584 
00590     <font class="keywordtype">void</font> updateAsciiStream(<font class="keywordtype">int</font> idx, ODBCXX_STREAM* s, <font class="keywordtype">int</font> len);
00591 
00597     <font class="keywordtype">void</font> updateAsciiStream(<font class="keyword">const</font> ODBCXX_STRING&amp; colName, ODBCXX_STREAM* s, <font class="keywordtype">int</font> len);
00598 
00599 
00605     <font class="keywordtype">void</font> updateBinaryStream(<font class="keywordtype">int</font> idx, ODBCXX_STREAM* s, <font class="keywordtype">int</font> len);
00606 
00612     <font class="keywordtype">void</font> updateBinaryStream(<font class="keyword">const</font> ODBCXX_STRING&amp; colName, ODBCXX_STREAM* s, <font class="keywordtype">int</font> len);
00613 
00617     <font class="keywordtype">void</font> updateNull(<font class="keyword">const</font> ODBCXX_STRING&amp; colName);
00618   };
00619 
00620   
00621 
00622 }; <font class="comment">// namespace odbc</font>
00623 
00624 
00625 <font class="preprocessor">#endif // __ODBCXX_RESULTSET_H</font>
</pre></div><hr>
<div align=center>
<a class=footer href="http://orcane.net/freeodbc++/">Go back to the freeodbc++ homepage</a>
</div>
